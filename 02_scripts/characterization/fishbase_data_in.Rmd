---
title: "fishbase_data_in"
output: html_document
date: "2023-04-10"
---

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

library(tidyverse)
library(here)
library(rfishbase)

```



### Read in data

```{r}
data <- read_csv(here::here("01_data", "02_processed_data", "homerange_pld.csv")) %>%
  mutate(home_range = case_when(
    !is.na(observed_homerange) ~ observed_homerange,
    is.na(observed_homerange) ~ predicted_homerange
  )) %>%
  mutate(pld = case_when(
    !is.na(observed_pld) ~ observed_pld,
    is.na(observed_pld) ~ predicted_pld
  )) %>%
  filter(pld < 400) %>%
  mutate(magnitude_homerange = floor(log10(home_range))) %>%
  mutate(month_pld = ceiling(pld / 30))
```


```{r}

fish <- load_taxa() %>%  # load all taxonomic info from fishbase into fish, then
  filter(Species %in% data$species) # select only the rows containing species named in our homerange_pld data

# created a dataframe with 3 fewer rows?

order(data$species) # order the dataframes by species to look for missing species names
order(fish$Species)
data$species[!(data$species %in% fish$Species)] # find the species in data that are not included in fish
# 3 species not included in fish: Limanda ferruginea, Oblada melanura, Pennahia anea


diet <- fooditems(fish$Species, fields = c("Species", "FoodI", "FoodII", "FoodIII"))



```


use rename to rename column names

group by species using group_by()

use summarize() to see if you can collect the data from different columns in one column separated by commas, like nekton, zoobenthos. then each sp will have its associated prey listed. maybe paste()?

when you google stuff add the word tidyverse!! helps to get tidy commands in answers

use left_join(data,diet)
use names or unique to get info on columns or rows


```{r}


```

